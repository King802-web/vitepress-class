# 网络模型与协议族

本章节将详细介绍计算机网络中的分层模型及各种协议族，帮助你理解网络通信的基本架构和工作原理。

## 学习目标

完成本章学习后，你将能够：
- 理解网络分层模型的意义和优势
- 掌握OSI七层模型和TCP/IP四层模型的结构与功能
- 了解各层主要协议的工作原理
- 分析数据在网络各层之间的封装与解封装过程

## 教学内容

### 第一部分：网络分层模型基础（4学时）

#### 1. 分层架构的意义
- **模块化设计**：将复杂问题分解为可管理的子问题
- **标准化接口**：各层之间通过标准接口通信
- **技术演进**：单层技术可独立发展而不影响整体架构
- **故障隔离**：问题可被限制在特定层次，便于排查

#### 2. OSI七层模型详解
- **应用层**：为应用程序提供网络服务接口
- **表示层**：数据格式转换、加密解密、压缩解压缩
- **会话层**：建立、管理和终止会话连接
- **传输层**：端到端的数据传输服务
- **网络层**：路由选择和数据转发
- **数据链路层**：相邻节点间的数据传输
- **物理层**：比特流的传输和物理介质

#### 3. TCP/IP四层模型
- **应用层**：对应OSI的应用层、表示层和会话层
- **传输层**：对应OSI的传输层
- **网络层**：对应OSI的网络层
- **网络接口层**：对应OSI的数据链路层和物理层

#### 4. 两种模型的对比与映射
- **结构差异**：OSI七层vs TCP/IP四层
- **理论与实践**：OSI模型的理论性与TCP/IP模型的实用性
- **协议覆盖**：各层对应的主要协议
- **历史发展**：两种模型的演进历程

### 第二部分：物理层与数据链路层（6学时）

#### 1. 物理层基础
- **传输介质类型**
  - 有线介质：双绞线、同轴电缆、光纤
  - 无线介质：无线电波、微波、红外线
- **信号类型**
  - 数字信号与模拟信号
  - 基带传输与宽带传输
- **编码与调制技术**
  - 数字编码：曼彻斯特编码、差分曼彻斯特编码
  - 调制技术：振幅调制、频率调制、相位调制
- **物理层设备**
  - 中继器、集线器
  - 网卡物理接口

#### 2. 数据链路层原理
- **帧结构与格式**
  - 帧头与帧尾
  - 地址字段
  - 控制字段
  - 数据字段
- **MAC地址**
  - MAC地址格式与分配
  - 单播、多播、广播地址
  - OUI与设备标识
- **差错控制**
  - 奇偶校验
  - 循环冗余校验(CRC)
  - 校验和
- **流量控制**
  - 停止等待协议
  - 滑动窗口协议

#### 3. 以太网技术
- **以太网标准演进**
  - 传统以太网(10Mbps)
  - 快速以太网(100Mbps)
  - 千兆以太网(1Gbps)
  - 万兆以太网(10Gbps)及更高速率
- **以太网帧格式**
  - IEEE 802.3帧
  - 以太网II帧
  - 帧间隙与冲突检测
- **介质访问控制**
  - CSMA/CD工作原理
  - 全双工与半双工
  - 自动协商机制

#### 4. 其他链路层技术
- **点对点协议(PPP)**
  - PPP帧结构
  - LCP与NCP
  - 认证机制(PAP、CHAP)
- **无线局域网(WLAN)**
  - IEEE 802.11标准族
  - CSMA/CA机制
  - 无线帧结构
- **广域网技术**
  - 帧中继(Frame Relay)
  - ATM(异步传输模式)
  - MPLS基础

### 第三部分：网络层与传输层（8学时）

#### 1. IP协议详解
- **IPv4数据报结构**
  - 报头字段详解
  - 分片与重组
  - 选项字段
- **IPv4地址结构**
  - 地址分类(A/B/C/D/E)
  - 特殊地址(环回、私有、多播)
  - 子网划分与CIDR
- **IPv6基础**
  - IPv6地址格式与表示
  - IPv6报头结构
  - IPv4向IPv6过渡技术
- **IP路由原理**
  - 直接投递与间接投递
  - 路由表结构
  - 默认路由

#### 2. 路由选择协议
- **路由协议分类**
  - 内部网关协议与外部网关协议
  - 距离矢量协议与链路状态协议
- **RIP协议**
  - 距离矢量算法
  - 跳数限制与计数到无穷大
  - 触发更新与定时更新
- **OSPF协议**
  - 链路状态数据库
  - 区域划分
  - SPF算法
- **BGP协议基础**
  - AS自治系统
  - 路径属性
  - 路由策略

#### 3. 网络层辅助协议
- **ICMP协议**
  - 差错报告消息
  - 查询消息
  - ping与traceroute工作原理
- **ARP协议**
  - 地址解析过程
  - ARP缓存表
  - 代理ARP
- **DHCP协议**
  - 地址分配过程
  - DHCP报文类型
  - 租约更新机制
- **NAT技术**
  - 基本NAT与NAPT
  - NAT穿透问题
  - 端口映射

#### 4. TCP协议详解
- **TCP段结构**
  - 报头字段详解
  - 序列号与确认号
  - 标志位(SYN、ACK、FIN等)
- **TCP连接管理**
  - 三次握手过程
  - 四次挥手过程
  - 连接状态转换
- **TCP可靠传输机制**
  - 确认与重传
  - 滑动窗口
  - 快速重传与快速恢复
- **TCP流量控制与拥塞控制**
  - 接收窗口
  - 慢启动与拥塞避免
  - 拥塞窗口调整算法

#### 5. UDP协议
- **UDP数据报结构**
  - 报头字段
  - 无连接特性
- **UDP应用场景**
  - 实时应用
  - DNS查询
  - 流媒体传输
- **UDP与TCP对比**
  - 可靠性与效率
  - 连接开销
  - 应用选择依据

### 第四部分：应用层协议（6学时）

#### 1. HTTP/HTTPS协议
- **HTTP协议基础**
  - 请求方法(GET、POST等)
  - 状态码分类
  - 请求/响应报文结构
- **HTTP版本演进**
  - HTTP/1.0与持久连接
  - HTTP/1.1的改进
  - HTTP/2多路复用
  - HTTP/3与QUIC
- **HTTPS安全机制**
  - TLS/SSL协议
  - 证书验证过程
  - 加密套件
- **HTTP性能优化**
  - 缓存控制
  - 压缩传输
  - 内容分发网络(CDN)

#### 2. DNS协议
- **DNS系统架构**
  - 根域名服务器
  - 顶级域名服务器
  - 权威域名服务器
  - 递归解析服务器
- **DNS解析过程**
  - 递归查询与迭代查询
  - 缓存机制
  - 负载均衡
- **DNS记录类型**
  - A记录与AAAA记录
  - CNAME记录
  - MX记录
  - PTR记录
- **DNS安全**
  - DNS缓存污染
  - DNSSEC技术
  - DNS over HTTPS/TLS

#### 3. 电子邮件协议
- **SMTP协议**
  - 邮件传输过程
  - SMTP命令与响应
  - 邮件格式
- **POP3协议**
  - 邮件获取流程
  - POP3命令集
  - 离线处理模式
- **IMAP协议**
  - 与POP3的区别
  - 文件夹管理
  - 在线处理模式
- **邮件安全**
  - S/MIME
  - PGP加密
  - SPF与DKIM

#### 4. 文件传输协议
- **FTP协议**
  - 控制连接与数据连接
  - 主动模式与被动模式
  - FTP命令与响应码
- **TFTP协议**
  - 简化的文件传输
  - UDP传输
  - 应用场景
- **SFTP协议**
  - SSH文件传输
  - 安全特性
  - 与FTP对比
- **WebDAV协议**
  - HTTP扩展
  - 文件操作能力
  - 协作功能

#### 5. 其他重要应用层协议
- **SNMP协议**
  - 网络管理功能
  - MIB与OID
  - SNMP操作
- **NTP协议**
  - 时间同步机制
  - 层次结构
  - 精度控制
- **SIP协议**
  - VoIP通信
  - 会话建立过程
  - 信令与媒体分离
- **MQTT协议**
  - 物联网应用
  - 发布/订阅模型
  - QoS级别

### 第五部分：协议封装与解封装（4学时）

#### 1. 数据封装过程
- **应用层数据封装**
  - 应用数据格式化
  - 应用层头部添加
- **传输层封装**
  - 分段与端口信息
  - TCP/UDP头部添加
- **网络层封装**
  - IP头部添加
  - 路由信息包含
- **数据链路层封装**
  - MAC地址添加
  - 帧头帧尾构造
- **物理层编码**
  - 比特流转换
  - 物理信号生成

#### 2. 协议数据单元(PDU)
- **各层PDU命名**
  - 应用层：消息(Message)
  - 传输层：段/数据报(Segment/Datagram)
  - 网络层：分组/包(Packet)
  - 数据链路层：帧(Frame)
  - 物理层：比特(Bit)
- **PDU结构分析**
  - 头部结构
  - 数据部分
  - 尾部结构
- **PDU大小限制**
  - MTU与MSS
  - 分片与重组
  - 路径MTU发现

#### 3. 协议分析实践
- **Wireshark使用基础**
  - 接口选择与捕获过滤器
  - 显示过滤器语法
  - 协议解析视图
- **TCP/IP通信分析**
  - 三次握手捕获与分析
  - HTTP请求响应分析
  - TCP重传识别
- **网络问题诊断**
  - 延迟与丢包分析
  - 协议错误识别
  - 性能瓶颈定位
- **安全分析**
  - 异常流量识别
  - 协议漏洞分析
  - 加密流量特征

## 实践项目

1. **协议分析实验**：使用Wireshark捕获并分析各种网络协议通信过程，提交详细分析报告
   - 所需时间：6小时
   - 技术要求：Wireshark工具使用，TCP/IP协议知识
   - 评估标准：协议识别准确性，分析深度，问题诊断能力

2. **网络模型演示系统**：开发一个简单的可视化工具，演示数据在网络各层的封装与解封装过程
   - 所需时间：8小时
   - 技术要求：编程能力，网络协议知识
   - 评估标准：演示准确性，交互性，教育价值

3. **协议对比研究**：选择两个功能类似但实现不同的协议(如HTTP vs HTTPS，TCP vs QUIC)进行深入对比研究
   - 所需时间：5小时
   - 技术要求：文献研究能力，协议分析能力
   - 评估标准：对比全面性，技术理解深度，结论合理性

## 学习资源

### 推荐教材
1. 《计算机网络：自顶向下方法》(James F. Kurose, Keith W. Ross)
2. 《TCP/IP详解 卷1：协议》(Kevin R. Fall, W. Richard Stevens)
3. 《图解TCP/IP》(竹下隆史等)

### 在线资源
1. [RFC官方文档库](https://www.rfc-editor.org/)
2. [Wireshark网络协议分析器](https://www.wireshark.org/docs/)
3. [互联网工程任务组(IETF)](https://www.ietf.org/)
4. [网络协议图谱](https://www.iana.org/assignments/service-names-port-numbers/service-names-port-numbers.xhtml)

### 视频教程
1. [Stanford CS144: Introduction to Computer Networking](https://www.youtube.com/playlist?list=PLvFG2xYBrYAQCyz4Wx3NPoYJOFjvU7g2Z)
2. [Computerphile: Networking Videos](https://www.youtube.com/playlist?list=PLzH6n4zXuckpKAj1_88VS-8Z6yn9zX_P6)

## 评估方式
- 课堂参与：10%
- 实验报告：30%
- 项目作业：30%
- 期末考试：30% 